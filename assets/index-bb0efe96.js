var w=Object.defineProperty,A=Object.defineProperties;var C=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;var y=(e,t,a)=>t in e?w(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,B=(e,t)=>{for(var a in t||(t={}))E.call(t,a)&&y(e,a,t[a]);if(D)for(var a of D(t))I.call(t,a)&&y(e,a,t[a]);return e},F=(e,t)=>A(e,C(t));import{P as V}from"./index-46052efd.js";import{bf as L,aV as O,_ as S}from"./index.js";import{h as _,o as x}from"./antd-168c158e.js";import{d as N,r as P,h as W,c as f,G as $,a7 as r,Z as h,a8 as M,a9 as i,$ as s,l as u,E as g,a0 as d,_ as k,F as R,aa as U}from"./vue-ea98dac5.js";import"./useContentViewHeight-6fc1b870.js";import"./useWindowSizeFn-9a9a25b4.js";import"./onMountedOrActivated-3eb95ecd.js";import"./isNumber-6e063d5c.js";const G=N({components:{PageWrapper:V,[_.name]:_,InputTextArea:_.TextArea,Tag:x},setup(){const e=P({server:"ws://localhost:3300/test",sendValue:"",recordList:[]}),{status:t,data:a,send:v,close:b,open:T}=L(e.server,{autoReconnect:!1,heartbeat:!0});W(()=>{if(a.value)try{const o=JSON.parse(a.value);e.recordList.push(o)}catch(o){e.recordList.push({res:a.value,id:Math.ceil(Math.random()*1e3),time:new Date().getTime()})}});const n=f(()=>t.value==="OPEN"),c=f(()=>n.value?"success":"red"),l=f(()=>[...e.recordList].reverse());function p(){v(e.sendValue),e.sendValue=""}function m(){n.value?b():T()}return F(B({status:t,formatToDateTime:O},$(e)),{handlerSend:p,getList:l,toggle:m,getIsOpen:n,getTagColor:c})}}),J={class:"flex"},Z={class:"w-1/3 bg-white p-4"},j={class:"flex items-center"},q=s("span",{class:"text-lg font-medium mr-4"}," 连接状态: ",-1),z=s("hr",{class:"my-4"},null,-1),H={class:"flex"},K=s("p",{class:"text-lg font-medium mt-4"},"设置",-1),Q=s("hr",{class:"my-4"},null,-1),X={class:"w-2/3 bg-white ml-4 p-4"},Y=s("span",{class:"text-lg font-medium mr-4"}," 消息记录: ",-1),ee=s("hr",{class:"my-4"},null,-1),te={class:"max-h-80 overflow-auto"},se={class:"flex items-center"},ae=s("span",{class:"mr-2 text-primary font-medium"},"收到消息:",-1);function oe(e,t,a,v,b,T){const n=r("Tag"),c=r("a-input"),l=r("a-button"),p=r("InputTextArea"),m=r("PageWrapper");return h(),M(m,{title:"WebSocket 示例"},{default:i(()=>[s("div",J,[s("div",Z,[s("div",j,[q,u(n,{color:e.getTagColor},{default:i(()=>[g(d(e.status),1)]),_:1},8,["color"])]),z,s("div",H,[u(c,{value:e.server,"onUpdate:value":t[0]||(t[0]=o=>e.server=o),"addon-before":"服务地址",disabled:""},null,8,["value"]),u(l,{type:e.getIsOpen?"danger":"primary",onClick:e.toggle},{default:i(()=>[g(d(e.getIsOpen?"关闭连接":"开启连接"),1)]),_:1},8,["type","onClick"])]),K,Q,u(p,{placeholder:"需要发送到服务器的内容",disabled:!e.getIsOpen,value:e.sendValue,"onUpdate:value":t[1]||(t[1]=o=>e.sendValue=o),allowClear:""},null,8,["disabled","value"]),u(l,{type:"primary",block:"",class:"mt-4",disabled:!e.getIsOpen,onClick:e.handlerSend},{default:i(()=>[g(" 发送 ")]),_:1},8,["disabled","onClick"])]),s("div",X,[Y,ee,s("div",te,[s("ul",null,[(h(!0),k(R,null,U(e.getList,o=>(h(),k("li",{class:"mt-2",key:o.time},[s("div",se,[ae,s("span",null,d(e.formatToDateTime(o.time)),1)]),s("div",null,d(o.res),1)]))),128))])])])])]),_:1})}const _e=S(G,[["render",oe]]);export{_e as default};
